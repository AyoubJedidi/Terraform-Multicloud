#cloud-config

# Create user with passwordless sudo
users:
  - name: ${admin_username}
    groups: sudo
    shell: /bin/bash
    sudo: ALL=(ALL) NOPASSWD:ALL
    ssh_authorized_keys:
      - ${ssh_public_key}

# Security settings
ssh_pwauth: false
disable_root: true

# Update packages
package_update: true
package_upgrade: true

# Install required packages
packages:
  - python3
  - python3-pip
  - curl
  - wget
  - git

# Set timezone
timezone: Europe/Paris

# Run commands on first boot
runcmd:
  - echo "VM configured for Ansible automation" > /tmp/cloud-init-complete
  - echo "Setup complete at $(date)" >> /var/log/cloud-init-setup.log
